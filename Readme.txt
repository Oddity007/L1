Messy/incomplete code ahead.  Enter at your own peril.

(zlib license, copyright 2011-2013 Oliver Daids)
